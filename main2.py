from playwright.sync_api import sync_playwright
from time import sleep

student_ids = [
    "Yang, Alex",
    "Chang, Henry",
    "Nysather, James",
    "Leinhos, Michael",
    "Bhaskar, Vidhyacharan",
    "Wu, Gladys",
    "Sabit, Gul",
    "Mangarova, Nelly",
    "Lee, Ken",
    "Ghazvini, Mariam",
    "Dhamrait, Jessie",
    "Jagota, Arun",
    "Genc, Murat",
    "Khan, Arshad",
    "Tuncman, Isa",
    "Thakuri, Prakash",
    "Issa, Joseph",
    "Bince, Kevin",
    "Taqi, Yusser",
    "Kelman, Stanislav",
    "Shim, Daniel",
    "Tzacheva, Angelina",
    "Beketayev, Kenes",
    "Dabish, Dominic",
    "Baday, Murat",
    "Akhoirshida, Mohammed",
    "Millora, Lisa",
    "Lonescu, Alex",
    "Liu, Angie",
    "Smith, Nicole",
    "Khaliq, Anzar",
    "Hirani, Hari",
    "Bandari, Esfandiar",
    "Cirina, Lauren",
    "Dargahi, Aida",
    "Fitzgerald, Laura",
    "Ho, Denise",
    "Prows, Brian",
    "Mohammadsoltani, Zahra",
    "Cheng, Jessie",
    "Marina DelVecchio, Marina",
]

# student_ids = [
#     "19654",
#     "19656",
#     "19664",
#     "19667",
#     "19681",
#     "19737",
#     "19682",
#     "19670",
#     "19671",
#     "19673",
#     "19674",
#     "19676",
#     "19677",
#     "19679",
#     "19684",
#     "19685",
#     "19686",
#     "19687",
#     "19689",
#     "19691",
#     "19693",
#     "19695",
#     "19696",
#     "19697",
#     "19703",
#     "19704",
#     "19705",
#     "19709",
#     "19715",
#     "19717",
#     "19718",
#     "19719",
#     "19720",
#     "19724",
#     "19728",
#     "19729",
#     "19732",
#     "19733",
#     "19734",
#     "19735",
#     "19736",
#     "19738",
#     "19740",
#     "19741",
#     "19742",
#     "19745",
#     "19746",
#     "19747",
#     "19749",
#     "19750",
#     "19751",
#     "19754",
#     "19755",
#     "19759",
#     "19761",
#     "19762",
#     "19763",
#     "19766",
#     "19767",
#     "19768",
#     "19769",
#     "19788",
#     "19816KS",
#     "19770",
#     "19771",
#     "19772",
#     "19773",
#     "19775",
#     "19776",
#     "19777",
#     "19779",
#     "19780",
#     "19784",
#     "19785",
#     "19786",
#     "19787",
#     "19789",
#     "19790",
#     "19791",
#     "19794",
#     "19795",
#     "19796",
#     "19797",
#     "19798",
#     "19799",
#     "19800",
#     "19804",
#     "19805",
#     "19806",
#     "19808",
#     "19809",
#     "19811",
#     "19812",
#     "19813",
#     "19814",
#     "19815",
#     "19816",
#     "19817",
#     "19818",
#     "19819",
#     "19821",
#     "19823",
#     "19824",
#     "19825",
#     "19827",
#     "19828",
#     "19829",
#     "19830",
#     "19831",
#     "19833",
#     "19834",
#     "19835",
#     "19836",
#     "19837",
#     "19838",
#     "19840",
#     "19841",
#     "19842",
#     "19845",
#     "19846",
#     "19847",
#     "19848",
#     "19849",
#     "19850",
#     "19851",
#     "19852",
#     "19853",
#     "19855",
#     "19857",
#     "19858",
#     "19859",
#     "19860",
#     "19861",
#     "19862",
#     "19863",
#     "19864",
#     "19865",
#     "19871",
#     "19872",
#     "19873",
#     "19874",
#     "19875",
#     "19876",
#     "19877",
#     "19880",
#     "19881",
#     "19882",
#     "19883",
#     "19884",
#     "19885",
#     "19886",
#     "19887",
#     "19888",
#     "19889",
#     "19890",
#     "19891",
#     "19892",
#     "19893",
#     "19894",
#     "19895",
#     "19896",
#     "19899",
#     "19900",
#     "19902",
#     "19904",
#     "19905",
#     "19906",
#     "19907",
#     "19908",
#     "19909",
#     "19912",
#     "19913",
#     "19914",
#     "19915",
#     "19916",
#     "19918",
#     "19919",
#     "19920",
#     "19923",
#     "20018",
#     "19928",
#     "19929",
#     "19930",
#     "19932",
#     "19933",
#     "19934",
#     "19935",
#     "19936",
#     "19937",
#     "19938",
#     "19939",
#     "19940",
#     "19941",
#     "19942",
#     "19943",
#     "19944",
#     "19946",
#     "19947",
#     "19948",
#     "19949",
#     "19950",
#     "19952",
#     "19953",
#     "19954",
#     "19955",
#     "19957",
#     "19958",
#     "19959",
#     "19961",
#     "19962",
#     "19963",
#     "19964",
#     "19965",
#     "19966",
#     "19967",
#     "19968",
#     "19969",
#     "19970",
#     "19971",
#     "19972",
#     "19973",
#     "19974",
#     "19975",
#     "19976",
#     "19977",
#     "19979",
#     "19981",
#     "19983",
#     "19986",
#     "19987",
#     "19989",
#     "19990",
#     "19991",
#     "19993",
#     "19994",
#     "19996",
#     "19997",
#     "19998",
#     "19999",
#     "20001",
#     "20002",
#     "20003",
#     "20004",
#     "20005",
#     "20006",
#     "20007",
#     "20008",
#     "20009",
#     "20010",
#     "20011",
#     "20012",
#     "20013",
#     "20015",
#     "20016",
#     "20019",
#     "20020",
#     "20022",
#     "20023",
#     "20025",
#     "20026",
#     "20027",
#     "20028",
#     "20029",
#     "20030",
#     "20031",
#     "20032",
#     "20033",
#     "20034",
#     "20035",
#     "20036",
#     "20038",
#     "20039",
#     "20040",
#     "20041",
#     "20042",
#     "20043",
#     "20044",
#     "20046",
#     "20047",
#     "20048",
#     "20049",
#     "20050",
#     "20052",
#     "20053",
#     "20054",
#     "20055",
#     "20056",
#     "20057",
#     "20059",
#     "20060",
#     "17030",
#     "17577",
#     "18816",
#     "20065",
#     "20066",
#     "20067",
#     "20068",
#     "20069",
#     "20070",
#     "20071",
#     "20072",
#     "20073",
#     "20074",
#     "20075",
#     "20076",
#     "20077",
#     "20078",
#     "20079",
#     "20080",
#     "20081",
#     "20082",
#     "20083",
#     "20084",
#     "20085",
#     "20086",
#     "20087",
#     "20088",
#     "20089",
#     "20091",
#     "20092",
#     "20093",
#     "20094",
#     "20095",
#     "20096",
#     "20097",
#     "20098",
#     "20099",
#     "20100",
#     "20106",
#     "20107",
#     "20108",
#     "20109",
#     "20110",
#     "20111",
#     "20112",
#     "20113",
#     "20115",
#     "20116",
#     "20117",
#     "20118",
#     "20119",
#     "20120",
#     "20121",
#     "20124",
#     "20125",
#     "20126",
#     "20127",
#     "20128",
#     "20129",
#     "20130",
#     "20131",
#     "20132",
#     "20133",
#     "20135",
#     "20140",
#     "20141",
#     "20142",
#     "20145",
#     "20146",
#     "20147",
#     "20148",
#     "20152",
#     "20153",
#     "20154",
#     "20155",
#     "20156",
#     "20158",
#     "20159",
#     "20161",
#     "20162",
#     "20164",
#     "20165",
#     "20166",
#     "20168",
#     "20169",
#     "19638",
#     "20171",
#     "20172",
#     "20173",
#     "20174",
#     "20177",
#     "20178",
#     "20179",
#     "20180",
#     "20181",
#     "20182",
#     "20184",
#     "20185",
#     "20186",
#     "20189",
#     "20190",
#     "20191",
#     "20192",
#     "20193",
#     "20194",
#     "20197",
#     "20198",
#     "20199",
#     "20200",
#     "20201",
#     "20203",
#     "20204",
#     "20205",
#     "20206",
#     "20207",
#     "20208",
#     "20209",
#     "20210",
#     "20211",
#     "20213",
#     "20214",
#     "20215",
#     "20216",
#     "20219",
#     "20220",
#     "20221",
#     "20223",
#     "20224",
#     "20225",
#     "20229",
#     "20230",
#     "20231",
#     "20238",
#     "20246",
#     "20248",
#     "20251",
#     "20252",
#     "20255",
#     "20256",
#     "20265",
#     "20268",
#     "20277",
#     "20281",
#     "20282",
#     "20312",
#     "20316",
#     "20323",
#     "20329",
#     "20340",
#     "20352",
#     "20353",
#     "20357",
#     "20358",
#     "20363",
#     "20365",
#     "20368",
#     "20372",
#     "20446",
#     "20466",
#     "163938",
#     "16012",
#     "153874",
#     "163972",
#     "130572",
#     "163943",
#     "163945",
#     "163955",
#     "163958",
#     "163959",
#     "163960",
#     "163968",
#     "163977",
#     "164026",
#     "164041",
#     "164046",
#     "164063",
#     "162872",
#     "164110",
#     # Add all 400 IDs here
# ]

counter = 0
failed_ids = []

with sync_playwright() as playwright:
    browser = playwright.chromium.launch(headless=False, slow_mo=50)
    context = browser.new_context()
    page = context.new_page()

    page.goto("https://librarycat.org/admin/patrons")
    input("‚è∏Ô∏è  Log in if needed, then press ENTER...")

    for student_id in student_ids:
        try:
            print(f"\nüîç Processing ID: {student_id}")

            # Search
            search_box = page.locator('input[aria-controls="DataTables_Table_0"]')
            search_box.fill("")
            search_box.fill(student_id)
            sleep(2)

            # Click edit
            page.locator('i.fa-pencil').first.click()
            sleep(2)

            # Click Delete button in edit modal
            delete_button = page.locator('a.btn-danger[onclick*="deletepatron"]')
            delete_button.scroll_into_view_if_needed()
            sleep(0.5)
            delete_button.click()
            sleep(2)
            print(f"   ‚úì Clicked Delete")

            # Click the Delete button in confirmation dialog
            # It's an input with type="submit" and value="Delete"
            page.locator('input[type="submit"][value="Delete"]').click()
            sleep(2)
            print(f"   ‚úì Confirmed deletion")

            counter += 1
            print(f'‚úÖ [{counter}/{len(student_ids)}] ID: {student_id} --> Deleted Successfully!')

        except Exception as e:
            print(f'‚ùå ID: {student_id} --> Error: {str(e)}')
            failed_ids.append(student_id)
            try:
                page.keyboard.press('Escape')
                sleep(0.5)
            except:
                pass

        sleep(1)

    browser.close()

print(f"\n{'=' * 60}")
print(f"‚úÖ Total Deleted: {counter}")
print(f"‚ùå Total Failed: {len(failed_ids)}")
if failed_ids:
    print(f"\nFailed IDs:")
    for fid in failed_ids:
        print(f"  - {fid}")